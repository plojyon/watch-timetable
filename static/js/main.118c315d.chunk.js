(this["webpackJsonpwatch-timetable"]=this["webpackJsonpwatch-timetable"]||[]).push([[0],{15:function(t,e,r){},17:function(t,e,r){},19:function(t,e,r){"use strict";r.r(e);var a=r(1),n=r.n(a),s=r(9),i=r.n(s),o=(r(15),r(8)),c=r.n(o),h=r(10),u=r(3),l=r(4),d=r(2),p=r(6),b=r(5),f=(r(17),r(0));function g(t,e){var r=parseInt(t.substring(1,3),16),a=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16);return r=parseInt(r*(100+e)/100),a=(a=parseInt(a*(100+e)/100))<255?a:255,n=(n=parseInt(n*(100+e)/100))<255?n:255,"#"+(1===(r=r<255?r:255).toString(16).length?"0"+r.toString(16):r.toString(16))+(1===a.toString(16).length?"0"+a.toString(16):a.toString(16))+(1===n.toString(16).length?"0"+n.toString(16):n.toString(16))}var x=function(t){Object(p.a)(r,t);var e=Object(b.a)(r);function r(t){var a;return Object(u.a)(this,r),(a=e.call(this,t)).state={start:a.props.start,end:a.props.end,text:a.props.text,fontSize:a.props.fontSize,color:a.props.color,textColor:a.props.textColor,outline:a.props.outline||"",size:a.props.size,outerMargin:a.props.outerMargin,padding:a.props.padding,backgound:a.props.background,dim:a.props.dim,id:a.props.id||Math.floor(1e5*Math.random())},a.hourToAngle=a.hourToAngle.bind(Object(d.a)(a)),a}return Object(l.a)(r,[{key:"hourToAngle",value:function(t){var e=t%12*(2*Math.PI/12);return e-=Math.PI/2}},{key:"render",value:function(){var t={start:this.hourToAngle(this.state.start),end:this.hourToAngle(this.state.end)},e={};e.center=180-this.state.outerMargin-this.state.padding-this.state.size/2,e.outer=e.center+this.state.size/2,e.inner=e.center-this.state.size/2;var r=180-this.state.outerMargin-this.state.size/2,a=Math.atan(this.state.size/2/r);t.start+=a,t.end-=a;var n={};["start","end"].forEach((function(r){n[r]={},["outer","inner","center"].forEach((function(a){n[r][a]={},n[r][a].x=Math.round(Math.cos(t[r])*e[a]+180),n[r][a].y=Math.round(Math.sin(t[r])*e[a]+180)}))}));var s=Math.abs(this.state.start-this.state.end)>6?"1":"0",i=" M "+n.start.outer.x+" "+n.start.outer.y+" A "+this.state.size/2+" "+this.state.size/2+" 0 0 0 "+n.start.inner.x+" "+n.start.inner.y+" A "+e.inner+" "+e.inner+" 0 "+s+" 1 "+n.end.inner.x+" "+n.end.inner.y+" A "+this.state.size/2+" "+this.state.size/2+" 0 0 0 "+n.end.outer.x+" "+n.end.outer.y+" A "+e.outer+" "+e.outer+" 0 "+s+" 0 "+n.start.outer.x+" "+n.start.outer.y;return Object(f.jsxs)("svg",{viewBox:"0 0 360 360",style:{position:"absolute",top:"0",left:"0",width:"360px",height:"360px"},children:[Object(f.jsx)("path",{id:"curve_"+this.state.id,stroke:this.state.outline,fill:this.state.dim?g(this.state.color,-50):this.state.color,d:i}),Object(f.jsx)("text",{y:-(this.state.size-this.state.fontSize)/2+"",fontSize:1.4*this.state.fontSize+"px",style:{fill:this.state.textColor},children:Object(f.jsx)("textPath",{xlinkHref:"#curve_"+this.state.id,textAnchor:"middle",startOffset:"25%",children:this.state.text})})]})}}]),r}(a.Component),m=360,j=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],v=function(t){return 19*t+5},y=10,O=10,k=180-v(6)+(19-1.4*O),S=180-v(5)-1.4*y/2+2,M=function(t){Object(p.a)(r,t);var e=Object(b.a)(r);function r(t){var a;return Object(u.a)(this,r),(a=e.call(this,t)).state={timetable:a.props.timetable,background:a.props.background,day:a.props.day,colorScheme:a.props.colorScheme,currentTime:new Date,status:"error",interval:0},a.getEvents=a.getEvents.bind(Object(d.a)(a)),a.getNextEvent=a.getNextEvent.bind(Object(d.a)(a)),a.refresh=a.refresh.bind(Object(d.a)(a)),a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var t=setInterval(this.refresh,5e3);this.setState({interval:t}),this.refresh()}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.interval)}},{key:"refresh",value:function(){var t=new Date,e=(t.getDay()+6)%7,r=30*t.getHours()-90;r+=.5*t.getMinutes();var a="",n=this.getNextEvent(t);"none"===n.type&&(a="Done for today"),"start"===n.type&&(a=n.abbr+" in "+n.eta.str),"end"===n.type&&(a=n.eta.str+" of "+n.abbr+" left"),this.setState({currentTime:t,today:e,timeRotation:r,status:a})}},{key:"getEvents",value:function(){var t=[];for(var e in this.state.timetable){var r={abbr:this.state.timetable[e].predmet.abbr,time:this.state.timetable[e].ura,day:this.state.timetable[e].dan,type:"start"},a={abbr:this.state.timetable[e].predmet.abbr,time:this.state.timetable[e].ura+this.state.timetable[e].trajanje,day:this.state.timetable[e].dan,type:"end"};t.push(r),t.push(a)}return t}},{key:"getNextEvent",value:function(t){var e=[];return this.getEvents().forEach((function(r,a){if(r.day===(t.getDay()+6)%7){var n=new Date(t.getTime());n.setHours(r.time),n.setMinutes(0);var s=n.getTime()-t.getTime();if(s>0){r.eta={},r.eta.ms=s,r.eta.str="";var i=Math.floor(s/1e3/60),o=Math.floor(i/60);i%=60,0!==o&&(r.eta.str+=o+" h "),0!==i&&(r.eta.str+=i+" min "),0===o&&0===i&&(r.eta.str="0"),r.eta.str.slice(0,-1),e.push(r)}}})),0===e.length?{type:"none"}:(e.sort((function(t,e){return t.eta.ms-e.eta.ms})),e[0])}},{key:"render",value:function(){var t=this;return void 0===this.state.today?Object(f.jsx)("p",{children:"Loading..."}):Object(f.jsxs)("div",{style:{backgroundColor:this.state.colorScheme.background,borderRadius:"50%",width:"360px",height:"360px"},children:[[0,1,2,3,4,5,6,7,8,9,10].map((function(e){return Object(f.jsx)("div",{style:{backgroundColor:e%2?t.state.colorScheme.background:t.state.colorScheme.background2,borderRadius:"50%",width:m-2*v(e)+"px",height:m-2*v(e)+"px",position:"fixed",top:v(e)+"px",left:v(e)+"px"}},e)})),this.state.timetable.map((function(e,r){return Object(f.jsx)(x,{id:r,start:e.ura,end:e.ura+e.trajanje,color:t.state.colorScheme[e.predmet.color],textColor:t.state.colorScheme.background,text:e.predmet.abbr,fontSize:13,size:15,outerMargin:v(e.dan),padding:2,background:e.dan%2?t.state.colorScheme.background:t.state.colorScheme.background2,dim:e.dan!==t.state.today},r)})),Object(f.jsx)("div",{style:{position:"absolute",top:"180px",left:"180px",width:"180px",height:"3px",transform:"rotate("+this.state.timeRotation+"deg)",transformOrigin:"0 0",backgroundColor:this.state.colorScheme.hand}}),Object(f.jsx)("img",{src:"logo192.png",alt:"logo",style:{position:"absolute",top:"135px",left:"135px",width:"90px",height:"90px"}}),Object(f.jsxs)("svg",{viewBox:"0 0 360 360",style:{position:"absolute",top:"0",left:"0",width:"360px",height:"360px"},children:[Object(f.jsx)("path",{id:"curve_status",fill:"none",d:" M 180 180 m -"+k+", 0 a "+k+","+k+" 0 1,1 "+2*k+",0"}),Object(f.jsx)("text",{y:"0",fontSize:1.4*O+"px",style:{fill:this.state.colorScheme.text},children:Object(f.jsx)("textPath",{xlinkHref:"#curve_status",textAnchor:"middle",startOffset:"50%",children:this.state.status})}),Object(f.jsx)("path",{id:"curve_day",fill:"none",d:" M 180 180 m -"+S+", 0 a "+S+","+S+" 0 1,0 "+2*S+",0"}),Object(f.jsx)("text",{y:"0",fontSize:1.4*y+"px",style:{fill:this.state.colorScheme.text},children:Object(f.jsx)("textPath",{xlinkHref:"#curve_day",textAnchor:"middle",startOffset:"50%",children:j[this.state.today]})})]})]})}}]),r}(a.Component),T={background:"#222222",background2:"#2c2c2d",hand:"red",text:"white",red:"#ff6188",orange:"#fc9868",yellow:"#ffd866",green:"#a9de77",blue:"#78dce8",purple:"#ab9df2"},z=function(t){Object(p.a)(r,t);var e=Object(b.a)(r);function r(t){var a;return Object(u.a)(this,r),(a=e.call(this,t)).state={timetable:!1,api_url:t.api_url||"https://yon.si/urnik.php",error:!1},a.fetchTableData=a.fetchTableData.bind(Object(d.a)(a)),a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.fetchTableData()}},{key:"fetchTableData",value:function(){var t=Object(h.a)(c.a.mark((function t(){var e,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.state.api_url,{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if(!(e=t.sent).ok){t.next=11;break}return t.next=6,e.json();case 6:r=t.sent,console.log(r),this.setState({timetable:r}),t.next=14;break;case 11:return console.error(e),this.setState({error:"error fetching timetable: "+e.status+": "+e.statusText}),t.abrupt("return",0);case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.timetable?Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(M,{timetable:this.state.timetable,colorScheme:T,refreshTimetable:this.fetchTableData})}):Object(f.jsx)("p",{style:{textAlign:"center"},children:"Loading"})}}]),r}(a.Component),w=function(t){t&&t instanceof Function&&r.e(3).then(r.bind(null,20)).then((function(e){var r=e.getCLS,a=e.getFID,n=e.getFCP,s=e.getLCP,i=e.getTTFB;r(t),a(t),n(t),s(t),i(t)}))};i.a.render(Object(f.jsx)(n.a.StrictMode,{children:Object(f.jsx)(z,{})}),document.getElementById("root")),w()}},[[19,1,2]]]);
//# sourceMappingURL=main.118c315d.chunk.js.map